<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"
    />

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />

    <!-- App Name / PWA -->
    <meta name="application-name" content="ChatGeniusX" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="apple-mobile-web-app-title" content="ChatGeniusX" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="theme-color" content="#3b82f6" />
    <meta name="msapplication-TileColor" content="#3b82f6" />

    <!-- SEO Meta Tags -->
    <title>ChatGeniusX - Real-time Messaging App</title>
    <meta
      name="description"
      content="ChatGeniusX is a fast and modern real-time chat app for private messaging, and a sleek, user-friendly interface. Stay connected anytime, anywhere."
    />
    <meta
      name="keywords"
      content="ChatGeniusX, chat app, messaging app, real-time chat, instant messaging, private chat, online chat, mobile chat app, PWA chat"
    />
    <meta name="robots" content="index, follow" />
    <meta name="author" content="Abdullah Abbad / CodeGeniusDev" />
    <link rel="canonical" href="https://chatgeniusx.netlify.app" />

    <!-- Open Graph / Social Sharing -->
    <meta property="og:title" content="ChatGeniusX - Real-time Messaging App" />
    <meta
      property="og:description"
      content="ChatGeniusX is a fast and modern real-time chat app for private messaging, and a sleek, user-friendly interface. Stay connected anytime, anywhere."
    />
    <meta property="og:image" content="/icon.png" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://chatgeniusx.netlify.app" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:title"
      content="ChatGeniusX - Real-time Messaging App"
    />
    <meta
      name="twitter:description"
      content="ChatGeniusX is a fast and modern real-time chat app for private messaging, and a sleek, user-friendly interface. Stay connected anytime, anywhere."
    />
    <meta name="twitter:image" content="/icon.png" />
    <meta name="twitter:site" content="@codegenius.dev" />

    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="/icon.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="/icon.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/icon.png" />
    <link rel="apple-touch-icon" sizes="167x167" href="/icon.png" />

    <!-- iOS Splash Screen -->
    <link rel="apple-touch-startup-image" href="/icon.png" />

    <!-- Manifest -->
    <!-- <link rel="manifest" href="/manifest.json" /> -->

    <style>
      /* Prevent pull-to-refresh on mobile */
      body {
        overscroll-behavior-y: contain;
        -webkit-overflow-scrolling: touch;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script type="module" src="./src/main.jsx"></script>

    <!-- Service Worker Registration - Production Only -->
    <script>
      if ('serviceWorker' in navigator) {
        // Only register in production
        if (window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1') {
          window.addEventListener('load', () => {
            navigator.serviceWorker.register('/service-worker.js', {
              scope: '/',
              updateViaCache: 'none'  // CRITICAL: Never cache the SW itself
            })
            .then(reg => {
              console.log('âœ… SW registered');
              
              // Check for updates every 30 seconds
              setInterval(() => {
                reg.update();
              }, 30000);
            })
            .catch(err => console.error('âŒ SW registration failed:', err));
          });
        } else {
          // DEV: Unregister all service workers
          navigator.serviceWorker.getRegistrations().then(regs => {
            regs.forEach(reg => reg.unregister());
          });
          console.log('ðŸ”§ DEV MODE: Service workers disabled');
        }
      }
    </script>
  </body>
</html>
